"use strict";var X=Object.defineProperty;var j=(e,t,s)=>t in e?X(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var c=(e,t,s)=>(j(e,typeof t!="symbol"?t+"":t,s),s);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const d=require("bignumber.js");var T=(e=>(e.THOR="THOR",e.RUNE="RUNE",e["RUNE-67C"]="RUNE-67C",e["RUNE-B1A"]="RUNE-B1A",e.ATOM="ATOM",e.MUON="MUON",e.USDC="USDC",e))(T||{}),o=(e=>(e.Avalanche="AVAX",e.Binance="BNB",e.BinanceSmartChain="BSC",e.Bitcoin="BTC",e.BitcoinCash="BCH",e.Cosmos="GAIA",e.Doge="DOGE",e.Ethereum="ETH",e.Litecoin="LTC",e.THORChain="THOR",e))(o||{}),h=(e=>(e[e.AVAX=18]="AVAX",e[e.BCH=8]="BCH",e[e.BNB=8]="BNB",e[e.BSC=18]="BSC",e[e.BTC=8]="BTC",e[e.DOGE=8]="DOGE",e[e.ETH=18]="ETH",e[e.GAIA=6]="GAIA",e[e.LTC=8]="LTC",e[e.THOR=8]="THOR",e))(h||{});const p=(e,t,s=!1)=>{if(s)return"Synth";switch(e){case o.Bitcoin:case o.BitcoinCash:case o.Doge:case o.Litecoin:case o.THORChain:return"Native";case o.Cosmos:return t==="ATOM"?"Native":"GAIA";case o.Binance:return t==="BNB"?"Native":"BEP2";case o.BinanceSmartChain:return t==="BNB"?"Native":"BEP20";case o.Ethereum:return t==="ETH"?"Native":"ERC20";case o.Avalanche:return t==="AVAX"?"Native":"AVAX";default:return e}},O={prefix:"",decimalSeparator:".",groupSeparator:",",groupSize:3,secondaryGroupSize:0,fractionGroupSeparator:" ",fractionGroupSize:0,suffix:""};var g=(e=>(e[e.ROUND_DOWN=0]="ROUND_DOWN",e[e.ROUND_HALF_UP=1]="ROUND_HALF_UP",e[e.ROUND_UP=2]="ROUND_UP",e))(g||{}),N=(e=>(e[e.BASE_AMOUNT=0]="BASE_AMOUNT",e[e.ASSET_AMOUNT=1]="ASSET_AMOUNT",e))(N||{});const C={[0]:d.BigNumber.ROUND_DOWN,[1]:d.BigNumber.ROUND_HALF_UP,[2]:d.BigNumber.ROUND_UP},y={groupSeparator:"",decimalSeparator:"."};class r{constructor(t,s=0,i){c(this,"assetAmount");c(this,"baseAmount");c(this,"decimal");this.decimal=i;const n=10**i;s===0?(this.baseAmount=new d.BigNumber(t),this.assetAmount=this.baseAmount.dividedBy(n)):(this.assetAmount=new d.BigNumber(t),this.baseAmount=this.assetAmount.multipliedBy(n)),this.baseAmount=new d.BigNumber(this.baseAmount.integerValue(d.BigNumber.ROUND_DOWN))}static fromMidgard(t){return new r(t||0,0,h.THOR)}static fromBaseAmount(t,s){return new r(t,0,s)}static fromAssetAmount(t,s){return new r(t,1,s)}static fromNormalAmount(t){return new r(t||0,1,1)}static sorter(t,s){if(t.decimal!==s.decimal)throw new Error("Decimal must be same");return t.assetAmount.minus(s.assetAmount).toNumber()}add(t){return new r(this.assetAmount.plus(t.assetAmount),1,this.decimal)}sub(t){return new r(this.assetAmount.minus(t.assetAmount),1,this.decimal)}mul(t){return t instanceof r?new r(this.assetAmount.multipliedBy(t.assetAmount),1,this.decimal):new r(this.assetAmount.multipliedBy(t),1,this.decimal)}div(t){return t instanceof r?new r(this.assetAmount.dividedBy(t.assetAmount),1,this.decimal):new r(this.assetAmount.dividedBy(t),1,this.decimal)}gte(t){return t instanceof r?this.assetAmount.isGreaterThanOrEqualTo(t.assetAmount):this.assetAmount.isGreaterThanOrEqualTo(t)}gt(t){return t instanceof r?this.assetAmount.isGreaterThan(t.assetAmount):this.assetAmount.isGreaterThan(t)}lte(t){return t instanceof r?this.assetAmount.isLessThanOrEqualTo(t.assetAmount):this.assetAmount.isLessThanOrEqualTo(t)}lt(t){return t instanceof r?this.assetAmount.isLessThan(t.assetAmount):this.assetAmount.isLessThan(t)}eq(t){return t instanceof r?this.assetAmount.isEqualTo(t.assetAmount):this.assetAmount.isEqualTo(t)}toSignificant(t=8,s=8,i=O,n=0){return this.toSignificantBigNumber(t,i,n).decimalPlaces(s).toFormat()}toFixedDecimal(t=8,s=y,i=0){if(!Number.isInteger(t))throw new Error(`${t} is not an integer.`);if(t<=0)throw new Error(`${t} is not positive.`);return d.BigNumber.config({FORMAT:s}),new d.BigNumber(this.assetAmount.toFixed(t,C[i])).toFormat()}toFixed(t=8,s=O,i=0){return this.toFixedDecimal(t,s,i)}toAbbreviate(t=2){let s=this.assetAmount.toNumber();const i=["","K","M","B","T","Q","Q","s"];let n=0;for(;s>=1e3;)s/=1e3,n++;return`${s.toFixed(t)}${n>0?` ${i[n]}`:""}`}toSignificantBigNumber(t=8,s=O,i=0){if(!Number.isInteger(t))throw new Error(`${t} is not an integer.`);if(t<=0)throw new Error(`${t} is not positive.`);return d.BigNumber.config({FORMAT:s}),new d.BigNumber(this.assetAmount.toPrecision(t,C[i]))}}const z=(e,t=8,s=0)=>(d.BigNumber.config({FORMAT:O}),new d.BigNumber(e.toFixed(t,C[s])).toFormat()),P=({liquidityUnits:e,poolUnits:t,runeDepth:s})=>r.fromBaseAmount(s,h.THOR).mul(e).div(t),v=({liquidityUnits:e,poolUnits:t,assetDepth:s})=>r.fromBaseAmount(s,h.THOR).mul(e).div(t),F=({liquidityUnits:e,poolUnits:t,runeDepth:s})=>{const i=r.fromMidgard(e),n=r.fromBaseAmount(t,h.THOR),a=r.fromBaseAmount(s,h.THOR),m=i.mul(a),A=n.mul(n).mul(2),u=n.mul(i).mul(2),f=i.mul(i),R=n.mul(n).mul(n);return m.mul(A.sub(u).add(f)).div(R)},M=({liquidityUnits:e,poolUnits:t,assetDepth:s})=>{const i=r.fromMidgard(e),n=r.fromBaseAmount(t,h.THOR),a=r.fromBaseAmount(s,h.THOR),m=i.mul(a),A=n.mul(n).mul(2),u=n.mul(i).mul(2),f=i.mul(i),R=m.mul(A.sub(u).add(f)),E=n.mul(n).mul(n);return R.div(E)},Y=({percent:e,runeDepth:t,liquidityUnits:s,poolUnits:i})=>F({runeDepth:t,liquidityUnits:s,poolUnits:i}).mul(e),Q=({percent:e,assetDepth:t,liquidityUnits:s,poolUnits:i})=>M({assetDepth:t,liquidityUnits:s,poolUnits:i}).mul(e),K=({liquidityUnits:e,poolUnits:t,runeDepth:s,assetDepth:i,percent:n})=>({assetAmount:v({liquidityUnits:e,poolUnits:t,assetDepth:i}).mul(n),runeAmount:P({liquidityUnits:e,poolUnits:t,runeDepth:s}).mul(n)}),Z=({runeDepth:e,poolUnits:t,assetDepth:s,liquidityUnits:i,runeAmount:n,assetAmount:a})=>{const m=r.fromBaseAmount(e,h.THOR),A=r.fromBaseAmount(s,h.THOR),u=r.fromBaseAmount(t,h.THOR),f=r.fromBaseAmount(n,h.THOR),R=r.fromBaseAmount(a,h.THOR),E=f.mul(A),b=R.mul(m),q=f.mul(R),G=m.mul(A),W=u.mul(E.add(b.add(q.mul(2)))),_=E.add(b.add(G.mul(2))),k=W.div(_),$=r.fromMidgard(i).add(k),V=u.add($);return $.div(V).assetAmount.toNumber()},J=({runeAmount:e,assetAmount:t,runeDepth:s,assetDepth:i})=>{const n=r.fromBaseAmount(s,h.THOR),a=r.fromBaseAmount(i,h.THOR),m=r.fromBaseAmount(t,h.THOR),A=r.fromBaseAmount(e,h.THOR),u=m.mul(n).sub(a.mul(A)),f=a.mul(A).add(n.mul(a));return u.div(f).assetAmount.absoluteValue().toNumber()};var L=(e=>(e.BOND="BOND",e.DEPOSIT="+",e.LEAVE="LEAVE",e.THORNAME_REGISTER="~",e.UNBOND="UNBOND",e.UPGRADE="SWITCH",e.WITHDRAW="-",e.OPEN_LOAN="$+",e.CLOSE_LOAN="$-",e))(L||{});const tt=({symbol:e,ticker:t,chain:s})=>s==="ETH"&&t!=="ETH"?`${t}-${e.slice(-3)}`:e,et=(e,t)=>{switch(e){case"LEAVE":case"SWITCH":case"BOND":{const{address:s}=t;return`${e}:${s}`}case"UNBOND":{const{address:s,unbondAmount:i}=t;return`${e}:${s}:${i*10**8}`}case"~":{const{name:s,chain:i,address:n,owner:a}=t;return`${e}:${s}:${i}:${n}${a?`:${a}`:""}`}case"+":{const{chain:s,symbol:i,address:n,singleSide:a}=t;return a?`${e}:${s}/${i}::t:0`:`${e}:${s}.${i}${n?`:${n}`:""}`}case"-":{const{chain:s,ticker:i,symbol:n,basisPoints:a,targetAssetString:m,singleSide:A}=t,u=!A&&m?`:${m}`:"",f=tt({chain:s,symbol:n,ticker:i});return`${e}:${s}${A?"/":"."}${f}:${a}${u}`}case"$+":case"$-":{const{asset:s,address:i}=t;return`${e}:${s}:${i}`}default:return""}},x=(e,t)=>e===o.Bitcoin?"Bitcoin":e===o.Doge?"Dogecoin":e===o.Litecoin?"Litecoin":e===o.BitcoinCash?"Bitcoin Cash":e===o.Ethereum&&t==="ETH"?"Ethereum":t,st=e=>{if(e<0)throw new Error("Invalid number of year");return 10+e},it=e=>{if(e.length>30)return!1;const t=/^[a-zA-Z0-9+_-]+$/g;return!!e.match(t)},U=class{constructor(t,s,i=!1,n){c(this,"chain");c(this,"symbol");c(this,"ticker");c(this,"type");c(this,"network");c(this,"name");c(this,"decimal");c(this,"isSynth",!1);c(this,"L1Chain");c(this,"setDecimal",t=>{this.decimal=t||h[this.chain]||h.THOR});this.chain=t,this.symbol=s.toUpperCase(),this.ticker=n||s.toUpperCase().split("-")[0],this.type=p(t,this.ticker,i),this.name=i?`Synth ${this.ticker}`:this.ticker,this.network=x(t,this.ticker),this.decimal=i?h.THOR:h[t],this.isSynth=i,this.L1Chain=i?o.THORChain:t}static fromAssetString(t){var u;if(!t)return null;const s=t.includes("/"),[i,...n]=t.split(s?"/":"."),a=n.join("."),m=(u=a==null?void 0:a.split("-"))==null?void 0:u[0];return i&&a&&m?new U(i,a,s):null}getAssetObj(){if(this.isSynth){const t=`${this.chain.toLowerCase()}/${this.symbol.toLowerCase()}`;return{chain:o.THORChain,symbol:t,ticker:t}}return{chain:this.chain,symbol:this.symbol,ticker:this.ticker}}toString(){return`${this.chain}${this.isSynth?"/":"."}${this.symbol}`}toURLEncoded(){return`${this.isSynth?"THOR.":""}${this.chain}.${this.symbol}`}eq(t){return this.chain===t.chain&&this.symbol.toUpperCase()===t.symbol.toUpperCase()&&this.ticker.toUpperCase()===t.ticker.toUpperCase()&&this.isSynth===t.isSynth}shallowEq(t){return this.chain===t.chain&&this.symbol.toUpperCase()===t.symbol.toUpperCase()&&this.ticker.toUpperCase()===t.ticker.toUpperCase()}isRUNE(){return this.eq(D(o.THORChain))}identifier(){return`${this.chain}.${this.symbol}`}toSynth(){return this.isSynth?this:new U(o.THORChain,`${this.chain}/${this.symbol}`,!0)}};let l=U;c(l,"decodeFromURL",t=>{var i,n,a;let s=t.toUpperCase();return s.startsWith("THOR.")&&((i=s.split("THOR."))==null?void 0:i[1])!=="RUNE"&&(s=(a=(n=s.split("THOR."))==null?void 0:n[1])==null?void 0:a.replace(".","/")),U.fromAssetString(s)});const nt="THOR-0XA5F2211B9B8170F694421F2046281775E8468044",rt="RUNE-0X3155BA85D5F96B2D030A4966AF206230E46849CB",B={},D=e=>{if(B[e])return B[e];switch(e){case o.Avalanche:case o.Binance:case o.BitcoinCash:case o.Bitcoin:case o.Doge:case o.Ethereum:case o.Litecoin:{const t=new l(e,e);return B[e]=t,t}case o.BinanceSmartChain:{const t=new l(o.BinanceSmartChain,o.Binance);return t.setDecimal(18),B[e]=t,t}case o.Cosmos:{const t=new l(o.Cosmos,T.ATOM,!1,T.ATOM);return B[e]=t,t}case o.THORChain:{const t=new l(o.THORChain,T.RUNE,!1,T.RUNE);return B[e]=t,t}case"USD":{const t=new l(o.THORChain,"USD-USD",!1,"USD-USD");return B[e]=t,t}case"ETH_THOR":{const t=new l(o.Ethereum,nt);return t.setDecimal(18),B[e]=t,t}case"BNB_RUNE":{const t=new l(o.Binance,"RUNE-B1A");return B[e]=t,t}case"ETH_RUNE":{const t=new l(o.Ethereum,rt);return t.setDecimal(18),B[e]=t,t}default:return new l(o.THORChain,T.RUNE,!1,T.RUNE)}},ot=e=>e.eq(D(e.chain)),w=(e,t)=>t.find(s=>e.shallowEq(s.asset));class I extends r{constructor({baseAsset:s,quoteAsset:i,unitPrice:n,pools:a,priceAmount:m}){const A=r.fromAssetAmount(m?m.assetAmount:1,s.decimal);super(A.assetAmount,N.ASSET_AMOUNT,s.decimal);c(this,"baseAsset");c(this,"quoteAsset");c(this,"unitPrice");c(this,"price");c(this,"amount");if(this.amount=A,this.baseAsset=s,this.quoteAsset=i,n!==void 0)this.unitPrice=n,this.price=A.assetAmount.multipliedBy(n);else{if(!a)throw new Error("Pools must be provided if unitPrice omitted");if(this.unitPrice=new d.BigNumber(0),i)if(s.isRUNE()&&!i.isRUNE()){const u=w(i,a);u&&(this.unitPrice=u.runePriceInAsset.assetAmount)}else if(!s.isRUNE()&&i.isRUNE()){const u=w(s,a);u&&(this.unitPrice=u.assetPriceInRune.assetAmount)}else if(!s.isRUNE()&&!i.isRUNE()){const u=w(s,a),f=w(i,a);u&&f&&(this.unitPrice=u.assetPriceInRune.div(f.assetPriceInRune).assetAmount)}else this.unitPrice=new d.BigNumber(1);else if(s.isRUNE()){const u=a==null?void 0:a[0];u&&(this.unitPrice=u.runePriceInAsset.mul(u.assetUSDPrice).assetAmount)}else{const u=w(s,a);u&&(this.unitPrice=u.assetUSDPrice.assetAmount)}this.price=this.unitPrice.multipliedBy(A.assetAmount)}}raw(){return this.price}invert(){return new d.BigNumber(1).dividedBy(this.raw())}toCurrencyFormat(s=8,i=!0){var m;const n=i?this.toAbbreviateRaw(s):this.toFixedRaw(s);return!this.quoteAsset||this.quoteAsset.ticker==="USD"?`$${n}`:`${n} ${(m=this.quoteAsset)==null?void 0:m.ticker}`}toAbbreviateRaw(s=2){return r.fromAssetAmount(this.price,8).toAbbreviate(s)}toFixedRaw(s=8,i=O,n=g.ROUND_DOWN){return r.fromAssetAmount(this.price,8).toFixed(s,i,n)}toFixedInverted(s=8,i=O,n=g.ROUND_DOWN){return r.fromAssetAmount(this.invert(),8).toFixed(s,i,n)}}class S extends r{constructor(s,i){super(i.assetAmount,N.ASSET_AMOUNT,s.decimal);c(this,"asset");c(this,"amount");this.asset=s,this.amount=new r(i.assetAmount,N.ASSET_AMOUNT,s.decimal)}add(s){if(!this.asset.shallowEq(s.asset))throw new Error("asset must be same");return new S(this.asset,this.amount.add(s.amount))}sub(s){if(!this.asset.shallowEq(s.asset))throw new Error("asset must be same");return new S(this.asset,this.amount.sub(s.amount))}mul(s){let i;return s instanceof r?i=new r(this.assetAmount.multipliedBy(s.assetAmount),N.ASSET_AMOUNT,this.decimal):i=new r(this.assetAmount.multipliedBy(s),N.ASSET_AMOUNT,this.decimal),new S(this.asset,i)}div(s){let i;return s instanceof r?i=new r(this.assetAmount.dividedBy(s.assetAmount),N.ASSET_AMOUNT,this.decimal):i=new r(this.assetAmount.dividedBy(s),N.ASSET_AMOUNT,this.decimal),new S(this.asset,i)}toCurrencyFormat({significantDigits:s,format:i,rounding:n}={significantDigits:6,format:O,rounding:g.ROUND_DOWN},a=!1){const m=super.toSignificant(s,8,i,n);return a?`${this.asset.ticker} ${m}`:`${m} ${this.asset.ticker}`}totalPriceIn(s,i){return new I({baseAsset:this.asset,quoteAsset:s,pools:i,priceAmount:r.fromAssetAmount(this.assetAmount,this.decimal)})}}const at=e=>{const t=D(e),s=[o.Bitcoin,o.Litecoin,o.BitcoinCash].includes(e)?10001:[o.Doge].includes(e)?100000001:[o.Avalanche,o.Ethereum].includes(e)?10*10**9:e===o.THORChain?0:1;return new S(t,r.fromBaseAmount(s,t.decimal))};class H{constructor(t,s,i,n){c(this,"asset");c(this,"runeDepth");c(this,"assetDepth");c(this,"assetUSDPrice");c(this,"detail");this.asset=t,this.runeDepth=s,this.assetDepth=i,this.detail=n,this.assetUSDPrice=r.fromAssetAmount(n.assetPriceUSD,h.THOR)}static fromPoolData(t){const{asset:s,runeDepth:i,assetDepth:n}=t,a=l.fromAssetString(s);if(a&&i&&n){const m=r.fromBaseAmount(i,h.THOR),A=r.fromBaseAmount(n,h.THOR);return new H(a,m,A,t)}return null}get assetPriceInRune(){return this.runeDepth.div(this.assetDepth)}get runePriceInAsset(){return this.assetDepth.div(this.runeDepth)}}exports.Amount=r;exports.AmountType=N;exports.AssetAmount=S;exports.AssetEntity=l;exports.BN_FORMAT=O;exports.EMPTY_FORMAT=y;exports.MemoType=L;exports.Pool=H;exports.Price=I;exports.Rounding=g;exports.formatBigNumber=z;exports.getAssetShare=v;exports.getAssetType=p;exports.getAsymmetricAssetShare=M;exports.getAsymmetricAssetWithdrawAmount=Q;exports.getAsymmetricRuneShare=F;exports.getAsymmetricRuneWithdrawAmount=Y;exports.getEstimatedPoolShare=Z;exports.getLiquiditySlippage=J;exports.getMemoFor=et;exports.getMinAmountByChain=at;exports.getNetworkName=x;exports.getRuneShare=P;exports.getSignatureAssetFor=D;exports.getSymmetricWithdraw=K;exports.getTHORNameCost=st;exports.isGasAsset=ot;exports.validateTHORName=it;
//# sourceMappingURL=index.cjs.map
